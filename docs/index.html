<!doctype html>
<html lang="en">
    <head>
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
        />
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bulma@1.0.2/css/bulma.min.css"
        />
        <meta charset="UTF-8" />
        <meta
            name="description"
            content="ML-family programming language that you can write code smoothly"
        />

        <meta property="og:title" content="MLtalk" />
        <meta
            property="og:description"
            content="ML-family programming language that you can write code smoothly"
        />
        <meta
            property="og:image"
            content="https://kajizukataichi.github.io/MLtalk/image/logo.png"
        />
        <meta
            property="og:url"
            content="https://kajizukataichi.github.io/MLtalk/"
        />

        <meta name="twitter:card" content="summary_large_image" />
        <meta property="twitter:title" content="MLtalk" />
        <meta
            property="twitter:description"
            content="ML-family programming language that you can write code smoothly"
        />
        <meta
            property="twitter:image"
            content="https://kajizukataichi.github.io/MLtalk/image/logo.png"
        />

        <link rel="stylesheet" href="style.css" />
        <title>MLtalk</title>
    </head>
    <body>
        <div id="main">
            <nav class="navbar" role="navigation" aria-label="main navigation">
                <div class="navbar-menu">
                    <div class="navbar-start">
                        <a href="index.html" class="navbar-item"> Home </a>
                        <a href="book.html" class="navbar-item">
                            Documentation
                        </a>
                    </div>

                    <div class="navbar-end">
                        <div class="navbar-item">
                            <div class="buttons">
                                <a
                                    class="button is-dark is-inverted"
                                    href="https://github.com/KajizukaTaichi/MLtalk"
                                >
                                    <i class="fab fa-github"></i
                                    >&ThinSpace;Repository</a
                                >
                            </div>
                        </div>
                    </div>
                </div>
            </nav>

            <div id="top" class="container content">
                <img class="image" id="logo" src="image/logo.png" />
                <br />
                <p class="subtitle">
                    ML-family programming language that you can write code
                    smoothly
                </p>
                <hr />
                <a
                    class="button is-dark is-large is-inverted"
                    href="https://github.com/KajizukaTaichi/MLtalk"
                >
                    <i class="fab fa-github"></i>&MediumSpace;Getting started</a
                >
                &MediumSpace;
                <a
                    class="button is-dark is-large is-inverted"
                    href="./book.html"
                >
                    <i class="fas fa-book"></i>&MediumSpace;Learn more</a
                >
            </div>

            <section id="why-mltalk" class="section">
                <div class="container content">
                    <h2>Why MLtalk?</h2>
                    <p class="subtitle">
                        There's picked up main and important features of the
                        MLtalk accompanied by screen-shot
                    </p>
                    <div class="columns">
                        <div class="column is-one-third">
                            <div class="card custom-card">
                                <div class="card-content">
                                    <div class="media">
                                        <div class="media-content">
                                            <p class="title is-4">
                                                Pure Functional
                                            </p>
                                        </div>
                                    </div>
                                    <div class="content">
                                        In the MLtalk, pure function is default
                                        and recommended way for building
                                        trustable program. If you want features
                                        with side-effect even by all means,
                                        <code>effect</code> statement allows
                                        that.
                                    </div>
                                </div>
                                <div class="card-image">
                                    <figure class="image is-4by3">
                                        <img
                                            src="./image/effect.png"
                                            alt="Placeholder image"
                                        />
                                    </figure>
                                </div>
                            </div>
                        </div>
                        <div class="column is-one-third">
                            <div class="card custom-card">
                                <div class="card-content">
                                    <div class="media">
                                        <div class="media-content">
                                            <p class="title is-4">
                                                Type System
                                            </p>
                                        </div>
                                    </div>

                                    <div class="content">
                                        The MLtalk has powerful type system. It
                                        makes program more secure and
                                        high-performance thing. It's dynamic
                                        typed. So, If you hope certain function
                                        be typed, you can bind it dynamically
                                    </div>
                                </div>
                                <div class="card-image">
                                    <figure class="image is-4by3">
                                        <img
                                            src="./image/type.png"
                                            alt="Placeholder image"
                                        />
                                    </figure>
                                </div>
                            </div>
                        </div>
                        <div class="column is-one-third">
                            <div class="card custom-card">
                                <div class="card-content">
                                    <div class="media">
                                        <div class="media-content">
                                            <p class="title is-4">
                                                Error Handling
                                            </p>
                                        </div>
                                    </div>

                                    <div class="content">
                                        The MLtalk is integrate goal-directed
                                        evalution inspired by the Icon. So, you
                                        can use modern error handling structure.

                                        <code>if let</code> and
                                        <code>while let</code> statements
                                        provides more fun develop-exprience
                                    </div>
                                </div>
                                <div class="card-image">
                                    <figure class="image is-4by3">
                                        <img
                                            src="./image/repl.png"
                                            alt="Placeholder image"
                                        />
                                    </figure>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <section id="playground" class="section">
            <div class="container content">
                <h2>Playground</h2>
                <p class="subtitle">
                    You can try out MLtalk code on browser without having to
                    install
                </p>
                <div class="card has-background-light">
                    <div class="card-content content">
                        <div
                            id="playground-history"
                            style="height: 130px; overflow-y: scroll"
                        ></div>
                        <hr />
                        <input
                            id="playground-code"
                            class="input is-light code"
                        />
                    </div>
                </div>
            </div>
        </section>

        <footer class="footer">
            <div class="container content has-text-centered">
                <p>
                    <strong>&COPY;</strong> 2025 梶塚太智. All rights reserved
                </p>
            </div>
        </footer>

        <script type="module">
            import init, { MLtalk } from "./pkg/mltalk_wasm.js";

            let mltalkRuntime;
            (async function () {
                await init();
                mltalkRuntime = new MLtalk();
            })();

            let playgroundCode = document.getElementById("playground-code");
            let playgroundResult = document.getElementById("playground-result");
            let playgroundHistory =
                document.getElementById("playground-history");
            let historyList = [];
            let historyIndex = 0;

            const urlParams = new URLSearchParams(window.location.search);
            const id = urlParams.get("code");
            if (id !== null) {
                playgroundCode.value = id;
            }

            playgroundCode.addEventListener("keydown", (event) => {
                if (event.key == "Enter") {
                    let code = playgroundCode.value;
                    let result = mltalkRuntime.eval(code);
                    let is_fault = result.startsWith("Fault: ");
                    let resultToShow = `
                        <p id="playground-result" style="overflow-wrap: break-word" class="notification code">
                            <span style="color: ${is_fault ? "red" : "green"} "> => </span>${result}
                        </p>
                    `.trim();
                    historyList.push(code);
                    historyIndex = historyList.length;

                    let inputHist = document.createElement("p");
                    inputHist.id = "playground-code";
                    inputHist.className = "input is-light code";
                    inputHist.textContent = code;

                    console.log("TEST: " + inputHist.value);

                    playgroundCode.value = "";
                    playgroundHistory.appendChild(inputHist);
                    playgroundHistory.innerHTML += `${resultToShow}`;
                    playgroundHistory.scrollTo({
                        top: playgroundHistory.scrollHeight,
                        behavior: "smooth",
                    });
                } else if (event.key == "ArrowDown") {
                    historyIndex += 1;
                    let code = historyList[historyIndex];
                    if (code != null && code != undefined) {
                        playgroundCode.value = code;
                    } else {
                        historyIndex -= 1;
                    }
                    playgroundHistory.children[historyIndex * 2].scrollIntoView(
                        {
                            behavior: "smooth",
                        },
                    );
                } else if (event.key == "ArrowUp") {
                    historyIndex -= 1;
                    let code = historyList[historyIndex];
                    if (code != null && code != undefined) {
                        playgroundCode.value = code;
                    } else {
                        historyIndex += 1;
                    }
                    playgroundHistory.children[historyIndex * 2].scrollIntoView(
                        {
                            behavior: "smooth",
                        },
                    );
                }
            });
        </script>
    </body>
</html>
